exports.id=708,exports.ids=[708],exports.modules={3976:(a,b,c)=>{"use strict";c.d(b,{BN:()=>j,ao:()=>i,$S:()=>g});var d=c(6931);let e={NPS_API:100,RECREATION_GOV_API:95,STATE_PARK_API:90,MANUAL_CURATION:80,EMAIL_RESPONSE:75,OFFICIAL_WEBSITE_SCRAPE:60,WEB_SEARCH_SCRAPE:40};var f=c(6484);function g(a){if(!a)return"";let b=a.toLowerCase().trim().replace(/\s+/g," ").replace(/[^\w\s]/g,"");for(let[a,c]of Object.entries({"\\bnp\\b":"national park","\\bnm\\b":"national monument","\\bnf\\b":"national forest","\\bnwr\\b":"national wildlife refuge","\\bnra\\b":"national recreation area","\\bnps\\b":"national park service","\\bsp\\b":"state park","\\bsf\\b":"state forest","\\bsra\\b":"state recreation area","\\bcr\\b":"county recreation","\\bcp\\b":"county park","\\bcity\\b":"city park","\\bco\\b":"county","\\bst\\b":"state"}))b=b.replace(RegExp(a,"gi"),c);return(b=b.replace(/\b(state|county|city|park|recreation|area|preserve|reserve|forest|wildlife|refuge|national|monument|memorial|historic|site|center|centre)\b/gi,"")).trim()}async function h(a,b){if(!a||!b)return null;if(!(0,d.L)())throw Error("Supabase client not initialized");let c=g(a),{data:e,error:f}=await d.w.from("parks").select("*").eq("state",b);if(f)return console.error("Error finding existing park:",f),null;if(!e||0===e.length)return null;for(let a of e){let b=g(a.name);if(b===c||(b.includes(c)||c.includes(b))&&5>Math.abs(b.length-c.length))return a}return null}async function i(a,b){if(!(0,d.L)())throw Error("Supabase client not initialized");if(!a.name||!a.state)throw Error("Park name and state are required");let c=(0,f.NC)(a.state);a.state=c;let g=function(a){let b=(a||"").toUpperCase();return b.includes("NPS")?e.NPS_API:b.includes("RECREATION.GOV")||b.includes("RECREATION_GOV")?e.RECREATION_GOV_API:b.includes("STATE")&&b.includes("API")?e.STATE_PARK_API:"PUBLIC FEDERAL"===b||b.includes("PUBLIC_FEDERAL")?85:"PUBLIC STATE"===b||b.includes("PUBLIC_STATE")||"STATE AGENCY"===b||b.includes("STATE_AGENCY")?80:"COUNTY AGENCY"===b||b.includes("COUNTY_AGENCY")||"CITY AGENCY"===b||b.includes("CITY_AGENCY")?75:b.includes("MANUAL")?e.MANUAL_CURATION:b.includes("EMAIL")?e.EMAIL_RESPONSE:b.includes(".GOV")?e.OFFICIAL_WEBSITE_SCRAPE:e.WEB_SEARCH_SCRAPE}(b),i=function(a){let b=0,c={};if(a.name&&a.name.trim().length>0&&(b+=15,c.name=15),a.description&&a.description.trim().length>20&&(b+=10,c.description=10),a.latitude&&a.longitude){let d=parseFloat(a.latitude),e=parseFloat(a.longitude);!isNaN(d)&&!isNaN(e)&&d>=-90&&d<=90&&e>=-180&&e<=180&&(b+=25,c.coordinates=25)}if(a.website)try{new URL(a.website),b+=10,c.website=10}catch{}return(a.phone||a.email)&&(b+=10,c.contact=10),a.amenities&&Array.isArray(a.amenities)&&a.amenities.length>0&&(b+=10,c.amenities=10),a.activities&&Array.isArray(a.activities)&&a.activities.length>0&&(b+=5,c.activities=5),a.boundaries&&a.boundaries.length>0&&(b+=10,c.boundaries=10),a.data_source_priority>=90&&(b+=5,c.officialSource=5),{score:b,breakdown:c,timestamp:new Date().toISOString()}}(a).score,j=await h(a.name,c);if(j){let b=function(a,b){let c=a.data_source_priority||0,d=b.data_source_priority||0,e=a.data_quality_score||0,f=b.data_quality_score||0;return c>=90&&d<90?(console.log("\uD83D\uDEE1️ PROTECTED: Cannot overwrite API data"),{shouldUpdate:!1,reason:"Protected: API data cannot be overwritten by scraped data"}):d>c?(console.log("✅ UPDATE: Better data source"),{shouldUpdate:!0,reason:"Higher priority data source"}):d===c&&f>e?(console.log("✅ UPDATE: Better quality"),{shouldUpdate:!0,reason:"Improved data quality"}):(console.log("⏭️ SKIP: No improvement"),{shouldUpdate:!1,reason:"No quality improvement"})}(j,{...a,data_source_priority:g,data_quality_score:i});if(!b.shouldUpdate)return{action:"skipped",reason:b.reason,park:j};let{agency_type:c,website_url:e,...f}=function(a,b,c,d){let e={...a};for(let c of["name","description","latitude","longitude","website","phone","email","agency","amenities","activities","geometry"]){let d=a[c],f=b[c];!d||""===d||Array.isArray(d)&&0===d.length?null!=f&&""!==f&&(e[c]=f):null!=f&&""!==f&&(e[c]=d)}return b.latitude&&b.longitude&&(a.latitude&&a.longitude?0===a.latitude&&0===a.longitude&&(e.latitude=b.latitude,e.longitude=b.longitude):(e.latitude=b.latitude,e.longitude=b.longitude)),b.amenities&&Array.isArray(b.amenities)&&(e.amenities=[...new Set([...a.amenities||[],...b.amenities])]),void 0!==b.geometry&&null!==b.geometry&&""!==b.geometry&&(a.geometry&&""!==a.geometry?e.geometry=a.geometry:"string"==typeof b.geometry&&b.geometry.startsWith("SRID=")&&(e.geometry=b.geometry)),e.data_source_priority=Math.max(a.data_source_priority||0,c),e.data_quality_score=Math.max(a.data_quality_score||0,d),e.last_updated=new Date().toISOString(),e}(j,a,g,i);e&&(f.website=e);let{data:h,error:k}=await d.w.from("parks").update(f).eq("id",j.id).select().single();if(k)throw Error(`Failed to update park: ${k.message}`);return{action:"updated",park:h}}{let{agency_type:b,website_url:c,...e}=a;c&&(e.website=c);let f={...e,data_source_priority:g,data_quality_score:i,created_at:new Date().toISOString(),last_updated:new Date().toISOString()},{data:h,error:j}=await d.w.from("parks").insert(f).select().single();if(j)throw Error(`Failed to insert park: ${j.message}`);return{action:"added",park:h}}}async function j(a,b){let c={added:0,updated:0,skipped:0,errors:[]};for(let d of a)try{let a=await i(d,b);"added"===a.action?c.added++:"updated"===a.action?c.updated++:"skipped"===a.action&&c.skipped++}catch(a){c.errors.push({park:d?.name||"Unknown",error:a.message})}return c}},6484:(a,b,c)=>{"use strict";c.d(b,{NC:()=>e});let d={alabama:"AL",alaska:"AK",arizona:"AZ",arkansas:"AR",california:"CA",colorado:"CO",connecticut:"CT",delaware:"DE",florida:"FL",georgia:"GA",hawaii:"HI",idaho:"ID",illinois:"IL",indiana:"IN",iowa:"IA",kansas:"KS",kentucky:"KY",louisiana:"LA",maine:"ME",maryland:"MD",massachusetts:"MA",michigan:"MI",minnesota:"MN",mississippi:"MS",missouri:"MO",montana:"MT",nebraska:"NE",nevada:"NV","new hampshire":"NH","new jersey":"NJ","new mexico":"NM","new york":"NY","north carolina":"NC","north dakota":"ND",ohio:"OH",oklahoma:"OK",oregon:"OR",pennsylvania:"PA","rhode island":"RI","south carolina":"SC","south dakota":"SD",tennessee:"TN",texas:"TX",utah:"UT",vermont:"VT",virginia:"VA",washington:"WA","west virginia":"WV",wisconsin:"WI",wyoming:"WY","district of columbia":"DC","washington dc":"DC",dc:"DC"};function e(a){if(!a||"string"!=typeof a)return a;let b=a.trim();return 2===b.length?b.toUpperCase():d[b.toLowerCase()]||b}Object.fromEntries(Object.entries(d).map(([a,b])=>[b,a]))},6487:()=>{},6931:(a,b,c)=>{"use strict";c.d(b,{L:()=>h,w:()=>g});var d=c(3672);let e=process.env.NEXT_PUBLIC_SUPABASE_URL||"",f=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"",g=e&&f?(0,d.UU)(e,f):null;function h(){return null!==g}},8335:()=>{}};
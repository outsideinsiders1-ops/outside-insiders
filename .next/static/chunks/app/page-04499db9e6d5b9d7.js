(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1150:(e,s,n)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let a=n(5155),t=n(2115),l=n(4437);function r(e){return{default:e&&"default"in e?e.default:e}}n(6552);let i={loader:()=>Promise.resolve(r(()=>null)),loading:null,ssr:!0},c=function(e){let s={...i,...e},n=(0,t.lazy)(()=>s.loader().then(r)),c=s.loading;function o(e){let r=c?(0,a.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=!s.ssr||!!s.loading,o=i?t.Suspense:t.Fragment,d=s.ssr?(0,a.jsxs)(a.Fragment,{children:[null,(0,a.jsx)(n,{...e})]}):(0,a.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,a.jsx)(n,{...e})});return(0,a.jsx)(o,{...i?{fallback:r}:{},children:d})}return o.displayName="LoadableComponent",o}},1558:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>A});var a=n(5155),t=n(2115),l=n(6278),r=n.n(l),i=n(2111);let c=new Map;function o(e){let s=c.get(e);return s&&Date.now()-s.timestamp<12e4?s.data:null}async function d(e,s){let n=new URLSearchParams;e&&n.set("bounds",JSON.stringify(e)),s&&Object.keys(s).length>0&&n.set("filters",JSON.stringify(s));let a=await fetch("/api/parks?".concat(n.toString()));if(!a.ok){let e=await a.json().catch(()=>({error:"Failed to fetch parks"}));throw Error(e.message||e.error||"Failed to fetch parks")}return(await a.json()).parks||[]}let u={map:{defaultCenter:[35.5,-83],defaultZoom:9,nearMeZoom:11,detailZoom:13,minZoom:4,maxZoom:18}},h=()=>(0,a.jsx)("header",{className:"header",children:(0,a.jsxs)("div",{className:"header-content",children:[(0,a.jsx)("h1",{children:"Outside Insiders"}),(0,a.jsx)("p",{children:"Discover all public recreation spaces in one place"})]})});var m=n(2846);let p=e=>{let{parkCount:s,sortedByDistance:n}=e;return(0,a.jsxs)("div",{className:"stats",children:[(0,a.jsxs)("div",{className:"stats-left",children:[(0,a.jsxs)("span",{children:["Showing ",s," parks"]}),n&&(0,a.jsx)("span",{children:" (sorted by distance)"})]}),(0,a.jsxs)("div",{className:"legend",children:[(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.State}}),"State"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.COUNTY}}),"County"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.CITY}}),"City"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.NPS}}),"NPS"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.USFS}}),"USFS"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.BLM}}),"BLM"]}),(0,a.jsxs)("span",{className:"legend-item",children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.FWS}}),"FWS"]})]})]})},x=e=>{let{onLocationFound:s,mapboxToken:n}=e,[l,r]=(0,t.useState)(""),[i,c]=(0,t.useState)(!1),[o,d]=(0,t.useState)(null),u=async e=>{if(e.preventDefault(),l.trim()){c(!0),d(null);try{let e=await fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(encodeURIComponent(l),".json?access_token=").concat(n,"&country=us&limit=1")),a=await e.json();if(a.features&&a.features.length>0){let[e,n]=a.features[0].center,t=a.features[0].place_name;s({lat:n,lon:e,name:t}),d(null),console.log("Found location: ".concat(t))}else d('Location not found. Try "City, State" format.')}catch(e){console.error("Geocoding error:",e),d("Error searching location. Please try again.")}finally{c(!1)}}};return(0,a.jsxs)("div",{className:"search-container",children:[(0,a.jsxs)("form",{onSubmit:u,className:"search-form",children:[(0,a.jsxs)("div",{className:"search-input-wrapper",children:[(0,a.jsxs)("svg",{className:"search-icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,a.jsx)("path",{d:"m21 21-4.35-4.35"})]}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>r(e.target.value),placeholder:"Search location (e.g., Asheville, NC)",className:"search-input",disabled:i}),l&&(0,a.jsx)("button",{type:"button",onClick:()=>{r(""),d(null)},className:"search-clear",children:"✕"})]}),(0,a.jsx)("button",{type:"submit",className:"search-button",disabled:i||!l.trim(),children:i?"\uD83D\uDD0D...":"Search"})]}),o&&(0,a.jsx)("div",{className:"search-error",children:o})]})},g=e=>{let{onLocationFound:s}=e,[n,l]=(0,t.useState)(!1);return(0,a.jsx)("button",{className:"near-me-button",onClick:()=>{"geolocation"in navigator?(l(!0),navigator.geolocation.getCurrentPosition(e=>{s({lat:e.coords.latitude,lon:e.coords.longitude,isUserLocation:!0}),l(!1)},()=>{console.log("Location access denied or unavailable"),alert("Could not get your location. Please enable location services."),l(!1)},{enableHighAccuracy:!1,timeout:5e3,maximumAge:3e5})):alert("Geolocation is not supported by your browser")},disabled:n,title:"Find parks near me",children:(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"6"}),(0,a.jsx)("line",{x1:"12",y1:"18",x2:"12",y2:"22"}),(0,a.jsx)("line",{x1:"2",y1:"12",x2:"6",y2:"12"}),(0,a.jsx)("line",{x1:"18",y1:"12",x2:"22",y2:"12"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})},y=e=>{let{onClick:s,activeFilterCount:n}=e;return(0,a.jsxs)("button",{className:"filter-drawer-button",onClick:s,children:[(0,a.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,a.jsx)("line",{x1:"4",y1:"6",x2:"20",y2:"6"}),(0,a.jsx)("line",{x1:"4",y1:"12",x2:"20",y2:"12"}),(0,a.jsx)("line",{x1:"4",y1:"18",x2:"20",y2:"18"}),(0,a.jsx)("circle",{cx:"18",cy:"6",r:"2",fill:"white"}),(0,a.jsx)("circle",{cx:"8",cy:"12",r:"2",fill:"white"}),(0,a.jsx)("circle",{cx:"15",cy:"18",r:"2",fill:"white"})]}),(0,a.jsx)("span",{children:"Filters"}),n>0&&(0,a.jsx)("span",{className:"filter-badge",children:n})]})},f=e=>{let{isOpen:s,onClose:n,filters:l,onFiltersChange:r}=e,[i,c]=(0,t.useState)(!1),[o,d]=(0,t.useState)(!0),[u,h]=(0,t.useState)(!1),p=e=>{r({...l,landType:e,agencies:"STATE"===e||"COUNTY"===e||"CITY"===e?[]:l.agencies})},x=e=>{let s=l.agencies.includes(e)?l.agencies.filter(s=>s!==e):[...l.agencies,e];r({...l,agencies:s,landType:s.length>0?"ALL":l.landType})};return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"filter-drawer-backdrop",onClick:n}),(0,a.jsxs)("div",{className:"filter-drawer open",children:[(0,a.jsxs)("div",{className:"filter-drawer-header",children:[(0,a.jsx)("h2",{children:"Filters"}),(0,a.jsx)("button",{className:"filter-drawer-close",onClick:n,children:"✕"})]}),(0,a.jsxs)("div",{className:"filter-drawer-content",children:[(0,a.jsxs)("div",{className:"filter-section",children:[(0,a.jsxs)("button",{className:"filter-section-header",onClick:()=>c(!i),children:[(0,a.jsxs)("span",{className:"filter-section-title",children:["\uD83C\uDFAF Amenities",l.amenities.length>0&&(0,a.jsxs)("span",{className:"filter-count",children:[" ","(",l.amenities.length,")"]})]}),(0,a.jsx)("span",{className:"filter-section-arrow",children:i?"▼":"▶"})]}),i&&(0,a.jsx)("div",{className:"filter-section-content",children:m.$.amenities.map(e=>(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.amenities.includes(e.key),onChange:()=>(e=>{let s=l.amenities.includes(e)?l.amenities.filter(s=>s!==e):[...l.amenities,e];r({...l,amenities:s})})(e.key)}),(0,a.jsx)("span",{children:e.label})]},e.key))})]}),(0,a.jsxs)("div",{className:"filter-section",children:[(0,a.jsxs)("button",{className:"filter-section-header",onClick:()=>d(!o),children:[(0,a.jsxs)("span",{className:"filter-section-title",children:["Land Type","ALL"!==l.landType&&(0,a.jsx)("span",{className:"filter-count",children:" (1)"})]}),(0,a.jsx)("span",{className:"filter-section-arrow",children:o?"▼":"▶"})]}),o&&(0,a.jsxs)("div",{className:"filter-section-content",children:[(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"radio",name:"landType",checked:"ALL"===l.landType,onChange:()=>p("ALL")}),(0,a.jsx)("span",{children:"Show All"})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"radio",name:"landType",checked:"FEDERAL"===l.landType,onChange:()=>p("FEDERAL")}),(0,a.jsx)("span",{children:"Federal Lands Only"})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"radio",name:"landType",checked:"STATE"===l.landType,onChange:()=>p("STATE")}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.State}}),"State Parks Only"]})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"radio",name:"landType",checked:"COUNTY"===l.landType,onChange:()=>p("COUNTY")}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.COUNTY}}),"County Parks Only"]})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"radio",name:"landType",checked:"CITY"===l.landType,onChange:()=>p("CITY")}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.CITY}}),"City Parks Only"]})]})]})]}),(0,a.jsxs)("div",{className:"filter-section",children:[(0,a.jsxs)("button",{className:"filter-section-header",onClick:()=>h(!u),children:[(0,a.jsxs)("span",{className:"filter-section-title",children:["Federal Agencies",l.agencies.length>0&&(0,a.jsxs)("span",{className:"filter-count",children:[" ","(",l.agencies.length,")"]})]}),(0,a.jsx)("span",{className:"filter-section-arrow",children:u?"▼":"▶"})]}),u&&(0,a.jsxs)("div",{className:"filter-section-content",children:[(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.agencies.includes("NPS"),onChange:()=>x("NPS"),disabled:["STATE","COUNTY","CITY"].includes(l.landType)}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.NPS}}),"National Parks (NPS)"]})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.agencies.includes("USFS"),onChange:()=>x("USFS"),disabled:["STATE","COUNTY","CITY"].includes(l.landType)}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.USFS}}),"National Forests (USFS)"]})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.agencies.includes("FWS"),onChange:()=>x("FWS"),disabled:["STATE","COUNTY","CITY"].includes(l.landType)}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.FWS}}),"Fish & Wildlife (FWS)"]})]}),(0,a.jsxs)("label",{className:"filter-option",children:[(0,a.jsx)("input",{type:"checkbox",checked:l.agencies.includes("BLM"),onChange:()=>x("BLM"),disabled:["STATE","COUNTY","CITY"].includes(l.landType)}),(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"legend-dot",style:{backgroundColor:m.$.markerColors.BLM}}),"Bureau of Land Management (BLM)"]})]})]})]})]}),(()=>{let e=0;return"ALL"!==l.landType&&e++,e+=l.agencies.length,e+=l.amenities.length})()>0&&(0,a.jsx)("div",{className:"filter-drawer-footer",children:(0,a.jsx)("button",{className:"clear-all-filters",onClick:()=>{r({landType:"ALL",agencies:[],amenities:[]})},children:"Clear All Filters"})})]})]}):null};var j=n(1993),b=n(5704);let N=b.env.NEXT_PUBLIC_SUPABASE_URL,C=b.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,k=N&&C?(0,j.UU)(N,C):null;async function S(e){let{data:s,error:n}=await k.from("parks").select("boundary").eq("id",e).single();if(n)return console.error("Error fetching boundary:",n),null;if(!s||!s.boundary)return null;try{let e=null;if("string"==typeof s.boundary){let n=JSON.parse(s.boundary);"Polygon"===n.type?e=n.coordinates[0]:"MultiPolygon"===n.type&&(e=n.coordinates[0][0])}else"Polygon"===s.boundary.type?e=s.boundary.coordinates[0]:"MultiPolygon"===s.boundary.type&&(e=s.boundary.coordinates[0][0]);if(e&&e.length>0)return e.map(e=>[e[1],e[0]])}catch(e){console.error("Error parsing boundary:",e)}return null}let v=e=>{let{park:s,onClose:n,onBoundaryToggle:l}=e,[r,c]=(0,t.useState)(null),[o,d]=(0,t.useState)(!1);(0,t.useEffect)(()=>{s&&u()},[s]);let u=async()=>{d(!0);try{let e=await S(s.id);c(e),l&&e&&l(e,!0)}catch(e){console.error("Error loading boundary:",e)}finally{d(!1)}};return s?(0,a.jsxs)("div",{className:"detail-panel",children:[(0,a.jsx)("button",{className:"close-button",onClick:n,children:"✕"}),(0,a.jsxs)("div",{className:"detail-content",children:[s.alerts&&s.alerts.length>0&&(0,a.jsxs)("div",{className:"alerts-banner",children:[(0,a.jsx)("div",{className:"alert-icon",children:"⚠️"}),(0,a.jsxs)("div",{className:"alert-content",children:[(0,a.jsx)("h3",{children:"Important Alerts"}),s.alerts.map((e,s)=>(0,a.jsxs)("div",{className:"alert-item",children:[(0,a.jsx)("strong",{children:e.title}),(0,a.jsx)("p",{children:e.description}),e.url&&(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:"More Info →"})]},s))]})]}),(0,a.jsx)("h2",{children:s.name}),(0,a.jsxs)("div",{className:"info-badges",children:[s.entrance_fees&&s.entrance_fees.length>0&&(0,a.jsx)("span",{className:"badge fee-badge",children:"0"===s.entrance_fees[0].cost||"0.00"===s.entrance_fees[0].cost?"\uD83C\uDFAB Free Entry":"\uD83D\uDCB0 $".concat(s.entrance_fees[0].cost)}),s.distance&&(0,a.jsxs)("span",{className:"badge distance-badge",children:["\uD83D\uDCCD ",s.distance.toFixed(1)," miles away"]}),r&&(0,a.jsx)("span",{className:"badge boundary-indicator",title:"Park boundary displayed on map",children:"\uD83D\uDDFA Boundary Shown"}),o&&(0,a.jsx)("span",{className:"badge",children:"Loading boundary..."})]}),s.description&&(0,a.jsxs)("div",{className:"detail-section description-section",children:[(0,a.jsx)("h3",{children:"About This Park"}),(0,a.jsx)("p",{children:s.description})]}),(0,a.jsxs)("div",{className:"detail-grid",children:[s.operating_hours&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83D\uDD50 Hours Today"}),(0,a.jsx)("p",{className:"hours-today",children:(0,i.TF)(s.operating_hours)})]}),(s.phone||s.email)&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83D\uDCDE Contact"}),s.phone&&(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"tel:".concat(s.phone),children:s.phone})}),s.email&&(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"mailto:".concat(s.email),children:s.email})})]})]}),s.amenities&&Array.isArray(s.amenities)&&s.amenities.length>0&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83C\uDFD5️ Amenities"}),(0,a.jsx)("div",{className:"activities-tags",children:s.amenities.map((e,s)=>(0,a.jsx)("span",{className:"activity-tag",children:e},s))})]}),s.activities&&Array.isArray(s.activities)&&s.activities.length>0&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83E\uDD7E Activities"}),(0,a.jsx)("div",{className:"activities-tags",children:s.activities.map((e,s)=>(0,a.jsx)("span",{className:"activity-tag",children:e},s))})]}),(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"Location"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"State:"})," ",s.state]}),s.county&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"County:"})," ",s.county]}),s.city&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"City:"})," ",s.city]})]}),(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"Management"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",(0,i.uf)(s.agency)]}),s.agency_full_name&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Managed By:"})," ",s.agency_full_name]})]}),(0,a.jsxs)("div",{className:"detail-grid",children:[s.acres&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"Size"}),(0,a.jsxs)("p",{children:[Math.round(s.acres).toLocaleString()," acres"]})]}),s.designation_type&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"Designation"}),(0,a.jsx)("p",{children:s.designation_type})]})]}),s.weather_info&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83C\uDF24️ Weather Info"}),(0,a.jsx)("p",{children:s.weather_info})]}),s.directions_info&&(0,a.jsxs)("div",{className:"detail-section",children:[(0,a.jsx)("h3",{children:"\uD83D\uDE97 Getting There"}),(0,a.jsx)("p",{children:s.directions_info})]}),(0,a.jsxs)("div",{className:"detail-section action-links",children:[s.website&&(0,a.jsx)("a",{href:s.website,target:"_blank",rel:"noopener noreferrer",className:"action-button primary",children:"Visit Official Website →"}),(0,a.jsx)("a",{href:"https://www.google.com/maps/search/?api=1&query=".concat(s.latitude,",").concat(s.longitude),target:"_blank",rel:"noopener noreferrer",className:"action-button secondary",children:"Get Directions"})]}),(0,a.jsx)("div",{className:"detail-section coordinates-section",children:(0,a.jsxs)("p",{className:"coordinates-text",children:[s.latitude.toFixed(4),", ",s.longitude.toFixed(4)]})})]})]}):null};var T=n(5704);let w=r()(()=>Promise.all([n.e(896),n.e(240),n.e(475)]).then(n.bind(n,3475)),{loadableGenerated:{webpack:()=>[3475]},ssr:!1}),L=r()(()=>n.e(972).then(n.bind(n,4972)),{loadableGenerated:{webpack:()=>[4972]},ssr:!1}),F=r()(()=>Promise.all([n.e(240),n.e(949)]).then(n.bind(n,3949)),{loadableGenerated:{webpack:()=>[3949]},ssr:!1});function A(){let e,[s,n]=(0,t.useState)(null),{parks:l,loading:r,loadingMore:m,error:j,filters:b,setFilters:N,userLocation:C,setUserLocation:k,sortByDistance:S,setSortByDistance:A}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,[s,n]=(0,t.useState)([]),[a,l]=(0,t.useState)(!0),[r,u]=(0,t.useState)(!1),[h,m]=(0,t.useState)(null),[p,x]=(0,t.useState)({landType:"ALL",agencies:[],amenities:[]}),[g,y]=(0,t.useState)(null),[f,j]=(0,t.useState)(!1),b=(0,t.useRef)(null),N=(0,t.useRef)(null),C=(0,t.useRef)(!0);async function k(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a?u(!0):l(!0),m(null);try{let l=[];if(e&&e.north&&e.south&&e.east&&e.west){let s=function(e,s){if(!e)return"all_".concat(JSON.stringify(s));let n={north:Math.floor(10*e.north)/10,south:Math.floor(10*e.south)/10,east:Math.floor(10*e.east)/10,west:Math.floor(10*e.west)/10};return"".concat(JSON.stringify(n),"_").concat(JSON.stringify(s))}(e,p),n=o(s);if(n)console.log("Using client-cached parks for viewport"),l=n;else if(!N.current||Math.abs(N.current.north-e.north)>.3||Math.abs(N.current.south-e.south)>.3||Math.abs(N.current.east-e.east)>.3||Math.abs(N.current.west-e.west)>.3){console.log("Fetching parks from server for viewport:",e);var t=l=await d(e,p);if(c.set(s,{data:t,timestamp:Date.now()}),c.size>50){let e=c.keys().next().value;c.delete(e)}N.current=e}else l=o(s)||[]}else console.log("Loading all parks from server (no viewport bounds)"),l=await d(null,p);let r=l;if("STATE"===p.landType?r=r.filter(e=>e.agency&&e.agency.toLowerCase().includes("state")):"COUNTY"===p.landType?r=r.filter(e=>e.agency&&e.agency.toLowerCase().includes("county")):"CITY"===p.landType?r=r.filter(e=>e.agency&&(e.agency.toLowerCase().includes("city")||e.agency.toLowerCase().includes("municipal")||e.agency.toLowerCase().includes("town"))):"FEDERAL"===p.landType&&(r=r.filter(e=>["NPS","USFS","BLM","FWS"].includes(e.agency))),p.agencies.length>0&&(r=r.filter(e=>p.agencies.includes(e.agency))),p.amenities.length>0&&(r=r.filter(e=>!!e.amenities&&0!==e.amenities.length&&p.amenities.every(s=>e.amenities.some(e=>e.toLowerCase().includes(s.toLowerCase()))))),a&&s.length>0){let e=new Set(s.map(e=>e.id)),a=r.filter(s=>!e.has(s.id));n([...s,...a])}else n(r);C.current=!1}catch(e){m(e.message),console.error("Error loading parks:",e)}finally{l(!1),u(!1)}}return(0,t.useEffect)(()=>{b.current&&clearTimeout(b.current);let s=e&&N.current;return b.current=setTimeout(()=>{k(s)},800*!!s),()=>{b.current&&clearTimeout(b.current)}},[p,e]),{parks:(0,t.useMemo)(()=>{let e=s;return g&&(e=s.map(e=>({...e,distance:(0,i.gd)(g.lat,g.lon,e.latitude,e.longitude)}))),f&&g&&(e=[...e].sort((e,s)=>(e.distance||1/0)-(s.distance||1/0))),e},[s,g,f]),loading:a,loadingMore:r,error:h,filters:p,setFilters:x,userLocation:g,setUserLocation:y,sortByDistance:f,setSortByDistance:j,refetch:k}}(s),[M,P]=(0,t.useState)(u.map.defaultCenter),[_,E]=(0,t.useState)(u.map.defaultZoom),[O,D]=(0,t.useState)(null),[U,Y]=(0,t.useState)(!1),[B,I]=(0,t.useState)(null),R=(0,t.useCallback)(e=>{n(e)},[]),W=(0,t.useCallback)(e=>{k(e),P([e.lat,e.lon]),E(u.map.nearMeZoom),A(!0)},[k,A]),$=(0,t.useCallback)(async e=>{D(e),P([e.latitude,e.longitude]),E(u.map.detailZoom);try{let s=await fetch("/api/parks/".concat(e.id));if(s.ok){let e=await s.json();e.success&&e.park&&D(e.park)}else console.warn("Failed to fetch full park details, using basic info")}catch(e){console.error("Error fetching park details:",e)}},[]),Z=(0,t.useCallback)(()=>{D(null),I(null),E(C?u.map.nearMeZoom:u.map.defaultZoom)},[C]),G=(0,t.useCallback)(e=>{I(e)},[]),z=T.env.NEXT_PUBLIC_MAPBOX_TOKEN;return r&&0===l.length?(0,a.jsxs)("div",{className:"app",children:[(0,a.jsx)(h,{}),(0,a.jsx)("div",{className:"loading",children:"Loading parks..."})]}):j&&0===l.length?(0,a.jsxs)("div",{className:"app",children:[(0,a.jsx)(h,{}),(0,a.jsxs)("div",{className:"error",children:["Error loading parks: ",j]})]}):(0,a.jsxs)("div",{className:"app",children:[(0,a.jsx)(h,{}),(0,a.jsx)(x,{onLocationFound:W,mapboxToken:z}),(0,a.jsx)(y,{onClick:()=>Y(!0),activeFilterCount:(e=0,"ALL"!==b.landType&&e++,e+=b.agencies.length,e+=b.amenities.length)}),(0,a.jsx)(g,{onLocationFound:W}),(0,a.jsx)(f,{isOpen:U,onClose:()=>Y(!1),filters:b,onFiltersChange:N}),(0,a.jsxs)("div",{className:"main-content",children:[(0,a.jsxs)("div",{className:"map-container",style:{position:"relative"},children:[m&&l.length>0&&(0,a.jsx)("div",{style:{position:"absolute",top:"10px",right:"10px",background:"rgba(255, 255, 255, 0.9)",padding:"8px 12px",borderRadius:"4px",fontSize:"0.9rem",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Loading more parks..."}),(0,a.jsxs)(w,{center:M,zoom:_,onBoundsChange:R,children:[(0,a.jsx)(F,{onMarkerClick:$}),B&&O&&(0,a.jsx)(L,{boundary:B,parkName:O.name})]})]}),O&&(0,a.jsx)(v,{park:O,onClose:Z,onBoundaryToggle:G})]}),(0,a.jsx)(p,{parkCount:l.length,sortedByDistance:S})]})}},2111:(e,s,n)=>{"use strict";function a(e,s,n,a){let t=(n-e)*Math.PI/180,l=(a-s)*Math.PI/180,r=Math.sin(t/2)*Math.sin(t/2)+Math.cos(e*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*3959}function t(e){return({State:"State Park",COUNTY:"County Park",CITY:"City Park",NPS:"National Park Service",USFS:"U.S. Forest Service",BLM:"Bureau of Land Management",FWS:"Fish & Wildlife Service",ARMY:"U.S. Army / Corps of Engineers",NAVY:"U.S. Navy",FEDERAL:"Federal Land"})[function(e){if(!e)return"FEDERAL";let s=e.toLowerCase();return s.includes("state")?"State":s.includes("county")?"COUNTY":s.includes("city")||s.includes("municipal")||s.includes("town")?"CITY":"NPS"===e?"NPS":"USFS"===e?"USFS":"BLM"===e?"BLM":"FWS"===e?"FWS":"ARMY"===e||"Army"===e||"USACE"===e?"ARMY":"NAVY"===e||"Navy"===e?"NAVY":"FEDERAL"}(e)]||e}function l(e){if(!e||0===e.length)return null;let s=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][new Date().getDay()];return e[0][s]||"Hours not available"}n.d(s,{TF:()=>l,gd:()=>a,uf:()=>t})},2846:(e,s,n)=>{"use strict";n.d(s,{$:()=>a});let a={map:{defaultCenter:[35.5,-83],defaultZoom:7,nearMeZoom:10,detailZoom:12,minZoom:4,maxZoom:18},markerColors:{State:"#4a7c2f",COUNTY:"#0891b2",CITY:"#eab308",NPS:"#2563eb",USFS:"#92400e",BLM:"#ea580c",FWS:"#9333ea",ARMY:"#dc2626",NAVY:"#1e40af",FEDERAL:"#6b7280"},api:{scrape:"/api/scrape",sync:"/api/sync",upload:"/api/upload"},search:{debounceMs:300,minChars:2},amenities:[{key:"camping",label:"\uD83C\uDFD5️ Camping"},{key:"hiking",label:"\uD83E\uDD7E Hiking"},{key:"fishing",label:"\uD83C\uDFA3 Fishing"},{key:"swimming",label:"\uD83C\uDFCA Swimming"},{key:"boating",label:"⛵ Boating"},{key:"picnicking",label:"\uD83E\uDDFA Picnic Areas"},{key:"playground",label:"\uD83D\uDEDD Playground"},{key:"visitor center",label:"\uD83C\uDFDB️ Visitor Center"},{key:"restrooms",label:"\uD83D\uDEBB Restrooms"}],agencies:{federal:["NPS","USFS","BLM","FWS"],state:["State"],local:["COUNTY","CITY"]}}},4054:(e,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var n in s)Object.defineProperty(e,n,{enumerable:!0,get:s[n]})}(s,{bindSnapshot:function(){return r},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return i}});let n=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class a{disable(){throw n}getStore(){}run(){throw n}exit(){throw n}enterWith(){throw n}static bind(e){return e}}let t="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return t?new t:new a}function r(e){return t?t.bind(e):a.bind(e)}function i(){return t?t.snapshot():function(e,...s){return e(...s)}}},4437:(e,s,n)=>{"use strict";function a(e){let{reason:s,children:n}=e;return n}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return a}}),n(4553)},6249:(e,s,n)=>{Promise.resolve().then(n.bind(n,1558))},6278:(e,s,n)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return t}});let a=n(8140)._(n(1150));function t(e,s){var n;let t={};"function"==typeof e&&(t.loader=e);let l={...t,...s};return(0,a.default)({...l,modules:null==(n=l.loadableGenerated)?void 0:n.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),e.exports=s.default)},6552:(e,s,n)=>{"use strict";function a(e){let{moduleIds:s}=e;return null}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return a}}),n(5155),n(7650),n(8567),n(7278)},7828:(e,s,n)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"workAsyncStorageInstance",{enumerable:!0,get:function(){return a}});let a=(0,n(4054).createAsyncLocalStorage)()},8567:(e,s,n)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"workAsyncStorage",{enumerable:!0,get:function(){return a.workAsyncStorageInstance}});let a=n(7828)}},e=>{e.O(0,[993,441,255,358],()=>e(e.s=6249)),_N_E=e.O()}]);
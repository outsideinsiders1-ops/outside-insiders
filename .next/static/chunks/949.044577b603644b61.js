"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[949],{3949:(e,r,t)=>{t.r(r),t.d(r,{default:()=>i});var o=t(2115),n=t(7856),c=t.n(n),a=t(2111),s=t(2846);let i=e=>{let{onMarkerClick:r,map:t,mapLoaded:n}=e,i=(0,o.useRef)(null),l="parks-tiles-source",u="parks-clusters",d="parks-cluster-count",p="parks-unclustered";return(0,o.useEffect)(()=>{if(!t||!n)return;if(!t.isStyleLoaded())return void t.once("styledata",()=>{});let e=e=>{try{return void 0!==t.getLayer(e)}catch(e){return!1}},o=window.location.origin;if(!(e=>{try{return void 0!==t.getSource(e)}catch(e){return!1}})(l))try{t.addSource(l,{type:"vector",tiles:["".concat(o,"/api/tiles/parks/{z}/{x}/{y}")],minzoom:0,maxzoom:14,promoteId:"id"}),console.log("Vector tile source added")}catch(e){console.error("Error adding vector tile source:",e);return}if(!e(u))try{t.addLayer({id:u,type:"circle",source:l,"source-layer":"parks",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,100,30,750,40]}})}catch(e){console.error("Error adding cluster layer:",e)}if(!e(d))try{t.addLayer({id:d,type:"symbol",source:l,"source-layer":"parks",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}})}catch(e){console.error("Error adding cluster count layer:",e)}if(!e(p))try{t.addLayer({id:p,type:"circle",source:l,"source-layer":"parks",filter:["!",["has","point_count"]],paint:{"circle-color":["match",["get","agency"],"NPS",s.$.markerColors.NPS,"USFS",s.$.markerColors.USFS,"BLM",s.$.markerColors.BLM,"FWS",s.$.markerColors.FWS,"ARMY",s.$.markerColors.ARMY,"NAVY",s.$.markerColors.NAVY,"State",s.$.markerColors.State,"COUNTY",s.$.markerColors.COUNTY,"CITY",s.$.markerColors.CITY,s.$.markerColors.FEDERAL],"circle-radius":8,"circle-stroke-width":2,"circle-stroke-color":"#fff"}})}catch(e){console.error("Error adding unclustered layer:",e)}let f=e=>{let r=t.queryRenderedFeatures(e.point,{layers:[u]});if(r.length>0){let e=r[0].properties.cluster_id,o=t.getSource(l);o&&"function"==typeof o.getClusterExpansionZoom&&o.getClusterExpansionZoom(e,(e,o)=>{e||t.easeTo({center:r[0].geometry.coordinates,zoom:o})})}},y=e=>{let o=t.queryRenderedFeatures(e.point,{layers:[p]});if(o.length>0){let e=o[0].properties,n=o[0].geometry.coordinates,s={id:e.id,name:e.name,agency:e.agency,state:e.state,latitude:n[1],longitude:n[0],source_id:e.source_id,data_source:e.data_source,...e};i.current&&i.current.remove();let l=new(c()).Popup({offset:25,closeOnClick:!1,closeButton:!0}).setLngLat(n).setHTML('\n            <div class="popup-content" style="min-width: 200px;">\n              <h3 style="margin: 0 0 8px 0; font-size: 16px; font-weight: 600;">'.concat(s.name||"Unnamed Park",'</h3>\n              <p style="margin: 4px 0; font-size: 14px;"><strong>State:</strong> ').concat(s.state||"N/A",'</p>\n              <p style="margin: 4px 0; font-size: 14px;"><strong>Type:</strong> ').concat((0,a.uf)(s.agency),'</p>\n              <button \n                class="detail-button" \n                data-park-id="').concat(s.id,'"\n                style="\n                  margin-top: 8px;\n                  padding: 8px 16px;\n                  background-color: #007bff;\n                  color: white;\n                  border: none;\n                  border-radius: 4px;\n                  cursor: pointer;\n                  font-size: 14px;\n                  width: 100%;\n                "\n              >View Details</button>\n            </div>\n          ')).addTo(t);i.current=l,l.getElement().addEventListener("click",e=>{(e.target.classList.contains("detail-button")||e.target.closest(".detail-button"))&&(e.stopPropagation(),i.current&&(i.current.remove(),i.current=null),r&&r(s))})}};return t.on("click",u,f),t.on("click",p,y),()=>{t.off("click",u,f),t.off("click",p,y),i.current&&(i.current.remove(),i.current=null)}},[t,n,r]),(0,o.useEffect)(()=>()=>{i.current&&(i.current.remove(),i.current=null)},[]),null}}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[475],{3383:()=>{},3475:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var n=t(5155),o=t(2115),u=t(7856),l=t.n(u);t(3383);var c=t(5704);let a=e=>{let{center:r,zoom:t,children:u,onBoundsChange:a}=e,s=(0,o.useRef)(null),i=(0,o.useRef)(null),[d,f]=(0,o.useState)(!1),m=c.env.NEXT_PUBLIC_MAPBOX_TOKEN,h=(0,o.useRef)(null),g=(0,o.useMemo)(()=>r&&Array.isArray(r)&&2===r.length?r:[35.5,-83],[r]),p=(0,o.useMemo)(()=>null!=t?t:7,[t]);(0,o.useEffect)(()=>{if(!s.current||i.current)return;if(!function(){try{let e=document.createElement("canvas");return!!(e.getContext("webgl")||e.getContext("experimental-webgl")||e.getContext("webgl2"))}catch(e){return console.warn("WebGL check failed:",e),!1}}())return void console.error("WebGL not supported. Mapbox GL JS requires WebGL.");if(!m)return void console.error("Mapbox token not found");i.current=new(l()).Map({container:s.current,style:"mapbox://styles/mapbox/outdoors-v12",center:[g[1],g[0]],zoom:p,accessToken:m,renderWorldCopies:!1,maxPitch:60,antialias:!1}),i.current.addControl(new(l()).NavigationControl,"top-right");let e=()=>{if(!i.current||!a)return;let e=i.current.getBounds(),r=e.getNorthEast(),t=e.getSouthWest(),n={north:r.lat,south:t.lat,east:r.lng,west:t.lng};h.current&&clearTimeout(h.current),h.current=setTimeout(()=>{a(n)},500)};return i.current.on("load",()=>{f(!0),console.log("Mapbox GL map loaded"),a&&e()}),a&&(i.current.on("moveend",e),i.current.on("zoomend",e)),i.current.on("error",e=>{console.error("Mapbox GL error:",e)}),()=>{h.current&&clearTimeout(h.current),i.current&&(a&&(i.current.off("moveend",e),i.current.off("zoomend",e)),i.current.remove(),i.current=null,f(!1))}},[]),(0,o.useEffect)(()=>{if(i.current&&d){let e=i.current.getCenter(),r=i.current.getZoom(),t=[g[1],g[0]],n=Math.abs(e.lng-t[0])>1e-4||Math.abs(e.lat-t[1])>1e-4,o=Math.abs(r-p)>.1;(n||o)&&i.current.flyTo({center:t,zoom:p,duration:1e3})}},[g,p,d]);let b=o.Children.map(u,e=>o.isValidElement(e)?o.cloneElement(e,{map:i.current,mapLoaded:d}):e);return(0,n.jsx)("div",{ref:s,style:{height:"100%",width:"100%"},children:b})}}}]);